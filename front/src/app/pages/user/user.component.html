<div class="page-container">
  <div class="user page-container__main">
    <h1 class="user__title">Profil utilisateur</h1>
    
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="user__form">
      <div class="user__form-fields">
        <mat-form-field appearance="outline" class="user__form-field">
          <input matInput formControlName="name" placeholder="Username">
          <mat-error *ngIf="nameValidationMessage">
            {{ nameValidationMessage }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="user__form-field">
          <input matInput formControlName="email" placeholder="email@email.fr" type="email">
          <mat-error *ngIf="emailValidationMessage">
            {{ emailValidationMessage }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="user__form-field">
          <input matInput type="password" placeholder="Mot de passe">
        </mat-form-field>

        <div class="user__form-submit">
          <button 
            mat-flat-button 
            color="primary" 
            type="submit" 
            [disabled]="form.invalid || isLoading"
            class="user__button">
            Sauvegarder
          </button>
        </div>
      </div>
    </form>
  </div>

    <hr class="user__divider">

    <div class="topics page-container__main">

    <h1 class="user__subtitle">Abonnements</h1>

    @if (isLoading) {
      <div class="user__loading">
        <app-loader></app-loader>
      </div>
    }

    @if (onErrorFetchingSubscriptions) {
      <p class="user__error">
        Une erreur est survenue lors de la récupération des abonnements...
      </p>
    } @else if (!hasSubscriptions) {
      <p class="user__empty">
        Aucun abonnement...
      </p>
    } @else {
      <div class="user__grid">
        @for (topic of userSubscribedTopicsArray; track topic.id) {
          <div class="user__item">
            <app-topic-card 
              [id]="topic.id"
              [title]="topic.title"
              [description]="topic.description"
              [isSubscribed]="topic.isSubscribed"
              [isSubscribeCase]="false"
              [disableButton]="false"
              (onSubscribe)="unsubscribeFromTopic(topic.id)">
            </app-topic-card>
          </div>
        }
      </div>
    }
  </div>
</div>
